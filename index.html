<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Fuzzy Lyrics Pro</title>

<style>
:root {
  --neon:#00ff88; --blue:#00d4ff; --pink:#ff00ff; --yellow:#ffcc00;
  --bg:#0a0a0a; --card:#1a1a1a;
}

body {
  font-family:-apple-system,sans-serif;
  background:var(--bg); color:#e0e0e0;
  margin:0; overflow:hidden; touch-action:none;
}

/* Splash */
#splash-screen{
  position:fixed; inset:0;
  background:linear-gradient(rgba(0,0,0,.5),rgba(0,0,0,.9));
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  z-index:3000; transition:.8s;
}
#splash-screen.hidden{opacity:0;visibility:hidden}
.floating-title{
  font-size:4.5rem;font-weight:900;text-transform:uppercase;
  animation:neonDrift 5s infinite ease-in-out;
}
@keyframes neonDrift{
  0%,100%{color:var(--neon);text-shadow:0 0 20px var(--neon)}
  33%{color:var(--blue);text-shadow:0 0 20px var(--blue)}
  66%{color:var(--pink);text-shadow:0 0 20px var(--pink)}
}
.start-btn{
  background:var(--neon);color:black;border:none;
  padding:20px 50px;border-radius:50px;
  font-weight:bold;font-size:1.5rem;cursor:pointer;
}

/* Library */
.container{max-width:500px;margin:auto;padding:20px;display:none;height:100vh;overflow-y:auto}
.card{background:var(--card);padding:20px;border-radius:15px;margin-bottom:20px}
input,textarea{
  width:100%;padding:12px;background:#252525;color:white;
  border:1px solid #444;border-radius:8px;margin-bottom:10px;
}
.song-item{
  background:var(--card);padding:15px;border-radius:12px;
  margin-top:12px;border-left:4px solid var(--neon);
}

/* Performance */
#scroller-overlay{
  display:none;position:fixed;inset:0;background:black;z-index:1000;
}
#scroll-content{
  white-space:pre-wrap;font-family:Courier New,monospace;
  font-size:28px;line-height:2.3;
  padding:50vh 20px 80vh;
  position:absolute;width:100%;color:white;
}
.focus-zone{
  position:fixed;top:50%;left:0;width:100%;height:85px;
  transform:translateY(-50%);
  background:rgba(0,255,136,.1);
  border-top:2px solid var(--neon);
  border-bottom:2px solid var(--neon);
  pointer-events:none;
}

.top-nav{
  position:fixed;top:10px;width:100%;display:flex;gap:6px;
  padding:0 5px;z-index:1005;
}
.nav-group{flex:1;text-align:center}
.nav-btn{
  width:100%;padding:12px;border:none;border-radius:10px;
  font-weight:bold;font-size:10px;cursor:pointer;
}
.mic-btn{background:#444;color:white}
.mic-on{background:var(--neon)!important;color:black!important}
.btn-yellow{background:var(--yellow)}
.btn-blue{background:var(--blue)}
.speed-readout{font-size:11px;font-weight:900;color:var(--blue)}

#big-countdown{
  position:fixed;top:50%;left:50%;
  transform:translate(-50%,-50%);
  font-size:10rem;font-weight:900;
  color:rgba(0,255,136,.35);
  pointer-events:none;display:none;z-index:1001;
}

#pause-status-bar{
  position:fixed;bottom:20px;left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.9);
  border:2px solid var(--neon);
  padding:15px 30px;border-radius:50px;
  display:none;font-weight:bold;
}
</style>
</head>

<body>

<div id="splash-screen">
  <div class="floating-title">Fuzzy<br>Lyrics</div>
  <button class="start-btn" onclick="enterApp()">START PERFORMANCE</button>
</div>

<div class="container" id="library-view">
  <h1 style="color:var(--neon);text-align:center;">Setlist Library</h1>
  <div class="card">
    <input id="songTitle" placeholder="Song Title">
    <input id="songLength" type="number" placeholder="Secs (guide)">
    <textarea id="songText" rows="8" placeholder="Lyrics & Chords..."></textarea>
    <button class="start-btn" style="width:100%;font-size:1rem" onclick="saveSong()">SAVE</button>
    <div style="opacity:.6;margin-top:10px;text-align:center;">Setlist Mode – Coming Soon</div>
  </div>
  <div id="songList"></div>
</div>

<div id="scroller-overlay">
  <div id="big-countdown">10</div>
  <div class="focus-zone"></div>
  <div class="top-nav">
    <div class="nav-group"><button id="micBtn" class="nav-btn mic-btn">MIC</button></div>
    <div class="nav-group"><button class="nav-btn btn-yellow" onclick="adjustSpeed(1.1)">SLOWER</button></div>
    <div class="nav-group"><button class="nav-btn" onclick="triggerPause()">PAUSE</button></div>
    <div class="nav-group">
      <button class="nav-btn btn-blue" onclick="adjustSpeed(0.9)">FASTER</button>
      <div id="speedIndicator" class="speed-readout">0%</div>
    </div>
    <div class="nav-group"><button class="nav-btn" onclick="exitSong()">EXIT</button></div>
  </div>
  <div id="scroll-content"></div>
  <div id="pause-status-bar">PAUSED – RESUMING IN <span id="pause-num">10</span>s</div>
</div>

<script>
let songs = JSON.parse(localStorage.getItem("fuzzy_index"))||[];
let currentIndex=0,currentSong=null;
let currentY=0,isPaused=true,isCounting=false;
let speedBase=0,speedMod=0,recognition=null,micOn=false;

function enterApp(){
  splash-screen.classList.add("hidden");
  setTimeout(()=>{library-view.style.display="block"},800);
  renderList();
}

function renderList(){
  songList.innerHTML=songs.map((s,i)=>`
    <div class="song-item">
      <b>${s.title}</b>
      <button onclick="playSong(${i})">PLAY</button>
    </div>`).join("");
}

function saveSong(){
  if(!songTitle.value||!songText.value)return;
  songs.push({title:songTitle.value,length:+songLength.value||180,text:songText.value});
  localStorage.setItem("fuzzy_index",JSON.stringify(songs));
  songTitle.value=songText.value="";
  renderList();
}

function playSong(i){
  currentIndex=i; currentSong=songs[i];
  scroll-content.innerText=currentSong.text+"\n\n--- FINISH ---";
  scroller-overlay.style.display="block";
  currentY=0; speedMod=0;
  speedBase=scroll-content.scrollHeight/currentSong.length;
  startCountdown();
}

function startCountdown(){
  let c=10; isPaused=true; isCounting=true;
  big-countdown.style.display="block"; big-countdown.innerText=c;
  let t=setInterval(()=>{
    c--; big-countdown.innerText=c;
    if(c<=0){clearInterval(t);big-countdown.style.display="none";
      isPaused=false;isCounting=false;requestAnimationFrame(scroll);}
  },1000);
}

function scroll(){
  if(isPaused)return;
  currentY+=speedBase*(1+speedMod);
  scroll-content.style.transform=`translateY(-${currentY}px)`;
  if(currentY<scroll-content.scrollHeight) requestAnimationFrame(scroll);
}

function triggerPause(){
  if(isCounting)return;
  isPaused=true; pause-status-bar.style.display="block";
  let c=10; pause-num.innerText=c;
  let t=setInterval(()=>{
    c--; pause-num.innerText=c;
    if(c<=0){clearInterval(t);pause-status-bar.style.display="none";startCountdown();}
  },1000);
}

function adjustSpeed(f){
  speedMod+=f<1?0.1:-0.1;
  speedIndicator.innerText=Math.round(speedMod*100)+"%";
}

function exitSong(){
  let next=(currentIndex+1)%songs.length;
  playSong(next);
}

/* MIC TOGGLE */
micBtn.onclick=()=>{
  if(!recognition){
    const SR=window.webkitSpeechRecognition||window.SpeechRecognition;
    if(!SR)return;
    recognition=new SR(); recognition.continuous=true;
    recognition.onresult=e=>{
      let r=e.results[e.results.length-1][0].transcript.toLowerCase();
      if(r.includes("pause"))triggerPause();
      if(r.includes("resume"))isPaused=false;
    };
  }
  micOn=!micOn;
  micBtn.classList.toggle("mic-on",micOn);
  micOn?recognition.start():recognition.stop();
};
</script>
</body>
</html>
